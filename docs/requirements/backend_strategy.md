# バックエンド方針（切り替え可能性）

## 結論
- 接続先バックエンドは「変更」できるが、後から変えるほど移行コストが上がる。
- iOS/Android間の同期をやるなら、CloudKitのようなOS専用基盤ではなく、共通バックエンド（例: Supabase、自前API等）が必要。
- プラン（無料/有料）でバックエンドを分けるのは可能だが、実装・運用・テストの負担が大きい（実質“2系統の同期”を持つ）。

## どう設計すると切り替えやすいか
- ドメイン（作品/ファイル/スナップショット等）をバックエンド非依存にする。
- `SyncBackend` のような抽象（プロトコル）を作り、実装を差し替える（CloudKit実装 / Supabase実装）。
- ローカル（SwiftData等）を「正」とし、バックエンドは“同期先”として扱う（オフライン/リトライ/衝突解決をここに集約）。
- 可能なら同期の入力を「操作ログ（イベント）」に寄せ、差分/衝突を扱いやすくする。

## プラン別の現実的な分け方（例）
- 推奨: バックエンドは1つに固定し、プラン差は“容量/履歴上限/高度機能”で付ける。
- 代替案: 無料=OS専用同期（iCloud/Google）・有料=共通同期（Supabase等）
  - 注意: 作品データの移行（無料→有料/有料→無料）を用意しないとUXが破綻しやすい。

